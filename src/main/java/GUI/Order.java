/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package GUI;

import BLL.BLLBan;
import BLL.BLLChiTietHoaDon;
import BLL.BLLDoDung;
import BLL.BLLHoaDon;
import BLL.BLLKhac;
import BLL.BLLOrder;
import DTO.Ban;
import DTO.ChiTietHoaDon;
import DTO.DoDung;
import DTO.HoaDon;
import DTO.KhuVuc;
import DTO.KhuyenMai;
import DTO.LoaiBan;
import DTO.LoaiDoDung;
import EXTENDED.Caution;
import EXTENDED.MyComboBox;
import EXTENDED.QRCode;
import EXTENDED.Transform;

import java.awt.event.MouseEvent;
import java.util.ArrayList;
import javax.swing.SwingUtilities;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author dell 7559
 */
public class Order extends javax.swing.JPanel {

    /**
     * Creates new form Order
     */
    public Order() {
        initComponents();
        btnLuu.setEnabled(false);
        loadCBBKhuVuc();
        loadCBBLoaiBan();
        loadCBBDoDung();
        loadTblSanPham();
        loadCBBKhuyenMai();
        btnQuetMaQR.setVisible(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        ppmenu = new javax.swing.JPopupMenu();
        jMenuItem7 = new javax.swing.JMenuItem();
        jMenuItem8 = new javax.swing.JMenuItem();
        jMenuItem3 = new javax.swing.JMenuItem();
        jPanel9 = new javax.swing.JPanel();
        txtBan = new javax.swing.JTextField();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblSPDaGoi = new javax.swing.JTable();
        btnLuu = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        CBBSanPham = new javax.swing.JComboBox<>();
        jScrollPane4 = new javax.swing.JScrollPane();
        tblSanPham = new javax.swing.JTable();
        jPanel6 = new javax.swing.JPanel();
        jPanel11 = new javax.swing.JPanel();
        CBBKhuVuc = new javax.swing.JComboBox<>();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        CBBLoaiBan = new javax.swing.JComboBox<>();
        jScrollPane1 = new javax.swing.JScrollPane();
        jpnBan = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        btnChuyenBan = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        txtTienDoDung = new javax.swing.JLabel();
        txtTienGio = new javax.swing.JLabel();
        txtGioRa = new javax.swing.JLabel();
        txtGioVao = new javax.swing.JLabel();
        txtTongTien = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        btnXong = new javax.swing.JButton();
        btnThanhToan = new javax.swing.JButton();
        btnQuetMaQR = new javax.swing.JButton();
        jLabel8 = new javax.swing.JLabel();
        cbbKhuyenMai = new javax.swing.JComboBox<>();
        jLabel9 = new javax.swing.JLabel();
        txtThanhTien = new javax.swing.JLabel();
        txtTienKhuyenMai = new javax.swing.JLabel();
        txtTenKhuyenMai = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();

        jMenuItem7.setText("Cập nhật");
        ppmenu.add(jMenuItem7);

        jMenuItem8.setText("Chuyển bàn");
        ppmenu.add(jMenuItem8);

        jMenuItem3.setText("jMenuItem3");

        setMaximumSize(new java.awt.Dimension(32767, 1187));
        setPreferredSize(new java.awt.Dimension(1187, 715));

        txtBan.setEditable(false);
        txtBan.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        txtBan.setForeground(new java.awt.Color(0, 102, 102));
        txtBan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtBanActionPerformed(evt);
            }
        });

        tblSPDaGoi.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        tblSPDaGoi.setFocusable(false);
        tblSPDaGoi.setRowSelectionAllowed(false);
        tblSPDaGoi.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblMouseClicked(evt);
            }
        });
        tblSPDaGoi.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tblSPDaGoiPropertyChange(evt);
            }
        });
        jScrollPane3.setViewportView(tblSPDaGoi);

        btnLuu.setBackground(new java.awt.Color(51, 153, 0));
        btnLuu.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnLuu.setForeground(new java.awt.Color(255, 255, 255));
        btnLuu.setText("Lưu");
        btnLuu.setBorder(null);
        btnLuu.setBorderPainted(false);
        btnLuu.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnLuu.setEnabled(false);
        btnLuu.setFocusPainted(false);
        btnLuu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLuuActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(txtBan, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnLuu, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtBan, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 269, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnLuu, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        CBBSanPham.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        CBBSanPham.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CBBSanPhamItemStateChanged(evt);
            }
        });

        tblSanPham.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tblSanPham.setRowSelectionAllowed(false);
        tblSanPham.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSanPhamMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(tblSanPham);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(CBBSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 156, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 387, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(CBBSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 282, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        CBBKhuVuc.setName("Khu vực"); // NOI18N
        CBBKhuVuc.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CBBKhuVucItemStateChanged(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(51, 51, 51));
        jLabel1.setText("Khu vực :");

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(51, 51, 51));
        jLabel2.setText("Loại bàn : ");

        CBBLoaiBan.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CBBLoaiBanItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(CBBKhuVuc, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jLabel2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(CBBLoaiBan, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(57, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addComponent(jLabel1)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(CBBKhuVuc)
                        .addComponent(jLabel2)
                        .addComponent(CBBLoaiBan)))
                .addContainerGap())
        );

        javax.swing.GroupLayout jpnBanLayout = new javax.swing.GroupLayout(jpnBan);
        jpnBan.setLayout(jpnBanLayout);
        jpnBanLayout.setHorizontalGroup(
            jpnBanLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 799, Short.MAX_VALUE)
        );
        jpnBanLayout.setVerticalGroup(
            jpnBanLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 669, Short.MAX_VALUE)
        );

        jScrollPane1.setViewportView(jpnBan);

        btnChuyenBan.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        btnChuyenBan.setText("Tuỳ chọn");
        btnChuyenBan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnChuyenBanActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnChuyenBan, javax.swing.GroupLayout.PREFERRED_SIZE, 108, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(btnChuyenBan, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(153, 153, 153)));

        jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(51, 51, 51));
        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel3.setText("Từ :");
        jLabel3.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        jLabel4.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(51, 51, 51));
        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel4.setText("Đến :");
        jLabel4.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        jLabel5.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(51, 51, 51));
        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel5.setText("Tiền giờ :");
        jLabel5.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        jLabel6.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(51, 51, 51));
        jLabel6.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel6.setText("tiền đồ dùng :");
        jLabel6.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        jLabel7.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(51, 51, 51));
        jLabel7.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel7.setText("Tổng tiền:");
        jLabel7.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        txtTienDoDung.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtTienDoDung.setForeground(new java.awt.Color(51, 51, 51));
        txtTienDoDung.setPreferredSize(new java.awt.Dimension(20, 5));

        txtTienGio.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtTienGio.setForeground(new java.awt.Color(51, 51, 51));
        txtTienGio.setPreferredSize(new java.awt.Dimension(20, 5));

        txtGioRa.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtGioRa.setForeground(new java.awt.Color(51, 51, 51));
        txtGioRa.setPreferredSize(new java.awt.Dimension(20, 5));

        txtGioVao.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtGioVao.setForeground(new java.awt.Color(51, 51, 51));
        txtGioVao.setPreferredSize(new java.awt.Dimension(20, 5));

        txtTongTien.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtTongTien.setForeground(new java.awt.Color(51, 51, 51));
        txtTongTien.setPreferredSize(new java.awt.Dimension(20, 5));

        jPanel4.setLayout(new java.awt.GridLayout(1, 0));

        btnXong.setBackground(new java.awt.Color(0, 51, 153));
        btnXong.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnXong.setForeground(new java.awt.Color(255, 255, 255));
        btnXong.setText("Xong");
        btnXong.setBorderPainted(false);
        btnXong.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnXong.setEnabled(false);
        btnXong.setFocusPainted(false);
        btnXong.setOpaque(true);
        btnXong.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXongActionPerformed(evt);
            }
        });
        jPanel4.add(btnXong);

        btnThanhToan.setBackground(new java.awt.Color(0, 153, 51));
        btnThanhToan.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnThanhToan.setForeground(new java.awt.Color(255, 255, 255));
        btnThanhToan.setText("Thanh Toán");
        btnThanhToan.setBorderPainted(false);
        btnThanhToan.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnThanhToan.setEnabled(false);
        btnThanhToan.setFocusPainted(false);
        btnThanhToan.setOpaque(true);
        btnThanhToan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThanhToanActionPerformed(evt);
            }
        });
        jPanel4.add(btnThanhToan);

        btnQuetMaQR.setBackground(new java.awt.Color(0, 102, 102));
        btnQuetMaQR.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnQuetMaQR.setForeground(new java.awt.Color(255, 255, 255));
        btnQuetMaQR.setText("Quét mã QR");
        btnQuetMaQR.setBorderPainted(false);
        btnQuetMaQR.setFocusable(false);
        btnQuetMaQR.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnQuetMaQRActionPerformed(evt);
            }
        });

        jLabel8.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(51, 51, 51));
        jLabel8.setText("Khuyễn mãi : ");

        jLabel9.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(51, 51, 51));
        jLabel9.setText("Thành tiền : ");

        txtThanhTien.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtThanhTien.setForeground(new java.awt.Color(51, 51, 51));

        txtTenKhuyenMai.setFont(new java.awt.Font("Segoe UI", 0, 10)); // NOI18N

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel4, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 265, Short.MAX_VALUE)
            .addComponent(btnQuetMaQR, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 95, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbbKhuyenMai, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, 95, Short.MAX_VALUE))
                                    .addGap(6, 6, 6)
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(txtGioRa, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(txtGioVao, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(jLabel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jLabel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(txtTienDoDung, javax.swing.GroupLayout.DEFAULT_SIZE, 114, Short.MAX_VALUE)
                                        .addComponent(txtTienGio, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                    .addGap(3, 3, 3)))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(jLabel9)
                                .addGap(15, 15, 15)
                                .addComponent(txtThanhTien, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addComponent(txtTenKhuyenMai, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jLabel7, javax.swing.GroupLayout.DEFAULT_SIZE, 95, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(txtTienKhuyenMai, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(txtTongTien, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(txtGioVao, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(29, 29, 29)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(txtGioRa, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(34, 34, 34)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(txtTienGio, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(31, 31, 31)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(txtTienDoDung, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(32, 32, 32)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cbbKhuyenMai, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel8))
                .addGap(33, 33, 33)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtTongTien, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7))
                .addGap(31, 31, 31)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtTienKhuyenMai, javax.swing.GroupLayout.DEFAULT_SIZE, 22, Short.MAX_VALUE)
                    .addComponent(txtTenKhuyenMai, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(62, 62, 62)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel9)
                    .addComponent(txtThanhTien, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnQuetMaQR, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 35, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                    .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents
    public void loadBan(int maKhuVuc, int maLoaiBan) {
        ArrayList<Ban> list = BLLBan.timBanTheoMaLoaiVaKhuVuc(maKhuVuc, maLoaiBan);
        if (list == null) {
            return;
        }
        new BLLOrder().loadBan(jpnBan, list, txtBan, tblSPDaGoi, btnThanhToan);
    }

    public static int maCBBSanPham = 0;

    public void loadCBBDoDung() {
        ArrayList<LoaiDoDung> list = BLLDoDung.GetAllLoaiDoDung();
        BLLDoDung.DoVaoCBLoaiDoDung(list, CBBSanPham);
    }

    public void loadCBBKhuyenMai() {
        ArrayList<KhuyenMai> list = BLLOrder.layKhuyenMai();
        BLLOrder.loadComboBoxKhuyenMai(cbbKhuyenMai, list);
    }

    public void loadCBBLoaiBan() {
        ArrayList<LoaiBan> list = BLLKhac.GetAllLoaiBan();
        BLLOrder.loadComboBoxLoaiBan(CBBLoaiBan, list);
        MyComboBox cbbLoaiBan = (MyComboBox) CBBLoaiBan.getSelectedItem();
    }

    public void loadCBBKhuVuc() {
        ArrayList<KhuVuc> list = BLLKhac.GetAllKhuVuc();
        BLLOrder.loadComboBoxKhuVuc(CBBKhuVuc, list);
        MyComboBox cbbKhuVuc = (MyComboBox) CBBKhuVuc.getSelectedItem();
        loadCBBLoaiaBanOK = true;
    }

    // load tbl san pham 
    public void loadTblSanPham() {
        MyComboBox comboBox = (MyComboBox) CBBSanPham.getSelectedItem();
        maCBBSanPham = comboBox.MaInt();
        ArrayList<DoDung> arr = BLLDoDung.FindByLoaiDoDung(comboBox.MaInt());

        new BLLOrder().loadTableSanPham(tblSanPham, arr);
    }

    public void loadChiTietHoaDon() {
        BLLChiTietHoaDon.loadTable(tblSPDaGoi);
    }
    private void tblMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblMouseClicked
        // TODO add your handling code here:
        if (evt.getButton() == MouseEvent.BUTTON1) {
            int indexRow = tblSPDaGoi.getSelectedRow();
            int indexColumn = tblSPDaGoi.getSelectedColumn();
            int value = Integer.parseInt(tblSPDaGoi.getValueAt(indexRow, 2).toString());

            if (indexColumn == 1) {
                if (value == 1) {
                    return;
                }
                BLLOrder.clickBtntru(tblSPDaGoi, indexRow, value);
                btnLuu.setEnabled(true);
            } else if (indexColumn == 3) {
                BLLOrder.clickBtnThem(tblSPDaGoi, indexRow, value);
                btnLuu.setEnabled(true);
            } else if (indexColumn == 5) {
                String ten = tblSPDaGoi.getValueAt(indexRow, 0).toString();
                xoa = true;
                xoaTen = ten;
                BLLOrder.xoaRow(tblSPDaGoi, indexRow);
                btnLuu.setEnabled(true);
            }
        }
    }//GEN-LAST:event_tblMouseClicked
    public static ArrayList<ChiTietHoaDon> cthd;
    public static boolean xoa = false;
    public static String xoaTen = "";
    private void txtBanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtBanActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtBanActionPerformed

    private void btnLuuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLuuActionPerformed
        // TODO add your handling code here:
        String ten = txtBan.getText();
        ArrayList<Ban> arrBan = BLLBan.timBanTheoTenBan(ten);
        String tinhTrangBan = arrBan.get(0).getTinhTrang();
        if (tinhTrangBan.equals("0")) {
            Caution.ThongBaoDonGian("Thông báo", "Bàn này chưa mở không thể thêm");
            btnLuu.setEnabled(false);
            return;
        }
        int rowcount = tblSPDaGoi.getRowCount();
        int maBan = arrBan.get(0).getMaBan();

        ArrayList<HoaDon> arrHoaDon = BLLHoaDon.getAllDataByTinhTrang(maBan);
        for (int i = 0; i < rowcount; i++) {
            String tenDoDung = tblSPDaGoi.getValueAt(i, 0).toString();
            int soLuong = Integer.parseInt(tblSPDaGoi.getValueAt(i, 2).toString());
            double giaBan = Double.parseDouble(tblSPDaGoi.getValueAt(i, 4).toString());
            int maDoDung = BLLDoDung.loadMaBangTen(tenDoDung);
            if (maDoDung == 0) {
                return;
            }
            int maHoaDon = arrHoaDon.get(0).getMaHoaDon();
            ArrayList<ChiTietHoaDon> cthd = BLLChiTietHoaDon.finData(maHoaDon, maDoDung);
            System.out.println(cthd);
            if (cthd.size() == 0) {
                BLLChiTietHoaDon.themVaoHoaDon(maHoaDon, maDoDung, soLuong, giaBan);
            } else {
                int maChiTietHoaDon = cthd.get(0).getMaChiTietHoaDon();
                BLLChiTietHoaDon.updateSoLuong(soLuong, maChiTietHoaDon);
            }
        }
        if (xoa) {
            int maDoDung = BLLDoDung.loadMaBangTen(xoaTen);
            if (maDoDung == 0) {
                return;
            }

            int maHD = BLLOrder.maHoaDon;
            ArrayList<ChiTietHoaDon> cthd = BLLChiTietHoaDon.finData(maHD, maDoDung);
            if (cthd.size() == 0) {
                btnLuu.setEnabled(false);
                return;
            }
            int maChiTietHoaDon = cthd.get(0).getMaChiTietHoaDon();
            BLLChiTietHoaDon.xoaChiTietHoaDon(arrHoaDon, maChiTietHoaDon);
        }
        btnLuu.setEnabled(false);
    }//GEN-LAST:event_btnLuuActionPerformed

    private void tblSPDaGoiPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tblSPDaGoiPropertyChange
        // TODO add your handling code here:

    }//GEN-LAST:event_tblSPDaGoiPropertyChange

    private void tblSanPhamMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSanPhamMouseClicked
        // TODO add your handling code here:
        if (evt.getButton() == MouseEvent.BUTTON1) {
            int indexRow = tblSanPham.getSelectedRow();
            int indexColumn = tblSanPham.getSelectedColumn();
            String tenMon = tblSanPham.getValueAt(indexRow, 0).toString();
            if (tenMon.equals(xoaTen)) {
                xoa = false;
            }
            String tenBan = txtBan.getText();
            double gia = Double.parseDouble(tblSanPham.getValueAt(indexRow, 1).toString());
            if (indexColumn == 3) {
                new BLLOrder().goiMon(tblSPDaGoi, tenMon, gia, btnLuu, tenBan);
            }

        }
    }//GEN-LAST:event_tblSanPhamMouseClicked

    private void CBBKhuVucItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CBBKhuVucItemStateChanged
        // TODO add your handling code here:
        jpnBan.removeAll();
        MyComboBox cbbKhuVuc = (MyComboBox) CBBKhuVuc.getSelectedItem();
        if (CBBKhuVuc == null) {
            return;
        }
        int maKhuVuc = cbbKhuVuc.MaInt();
        if (!loadCBBLoaiaBanOK) {
            return;
        }
        MyComboBox cbbLoaiBan = (MyComboBox) CBBLoaiBan.getSelectedItem();
        if (cbbLoaiBan == null) {
            return;
        }
        int maLoaiBan = cbbLoaiBan.MaInt();
        loadBan(maKhuVuc, maLoaiBan);
        SwingUtilities.updateComponentTreeUI(jpnBan);
    }//GEN-LAST:event_CBBKhuVucItemStateChanged
    static boolean loadCBBLoaiaBanOK = false;
    private void CBBLoaiBanItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CBBLoaiBanItemStateChanged
        // TODO add your handling code here
        jpnBan.removeAll();

        MyComboBox cbbLoaiBan = (MyComboBox) CBBLoaiBan.getSelectedItem();
        if (cbbLoaiBan == null) {
            return;
        }
        MyComboBox cbbKhuVuc = (MyComboBox) CBBKhuVuc.getSelectedItem();
        int maLoaiBan = cbbLoaiBan.MaInt();
        int maKhuVuc = cbbKhuVuc.MaInt();
        loadBan(maKhuVuc, maLoaiBan);
        SwingUtilities.updateComponentTreeUI(jpnBan);

    }//GEN-LAST:event_CBBLoaiBanItemStateChanged

    private void CBBSanPhamItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CBBSanPhamItemStateChanged
        MyComboBox cBBB = (MyComboBox) CBBSanPham.getSelectedItem();
        int DVT = cBBB.MaInt();
        ArrayList<DoDung> arrdv = BLL.BLLDoDung.FindByLoaiDoDung(DVT);
        new BLL.BLLOrder().loadTableSanPham(tblSanPham, arrdv);
    }//GEN-LAST:event_CBBSanPhamItemStateChanged
    public static double tienDoDung = 0;
    private void btnThanhToanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThanhToanActionPerformed
        // TODO add your handling code here:
        String tenBan = txtBan.getText();
        BLL.BLLOrder.updateBanVeTrong(tenBan);
        //

        ArrayList<Ban> arrBan = BLLBan.timBanTheoTenBan(tenBan);
        int maBan = arrBan.get(0).getMaBan();

        ArrayList<HoaDon> arrHoaDon = BLLHoaDon.getAllDataByTinhTrang(maBan);
        int maHoaDon = arrHoaDon.get(0).getMaHoaDon();
        int khuyenMai = 0;

        txtTenKhuyenMai.setText(cbbKhuyenMai.getSelectedItem().toString());
        MyComboBox cbbKhuyenMai = (MyComboBox) this.cbbKhuyenMai.getSelectedItem();
        Object maKhuyenMai = cbbKhuyenMai.MaInt();
        ArrayList<KhuyenMai> arrKhuyenMai = BLLOrder.LayMaKhuyenMaiBangMa(maKhuyenMai);
        khuyenMai = arrKhuyenMai.get(0).getGiaTri();
        String tenKhuyenMai = arrKhuyenMai.get(0).getTenKhuyenMai();
        txtTenKhuyenMai.setText(tenKhuyenMai + khuyenMai + " %");

        
        tienDoDung = BLLChiTietHoaDon.tongTienDoDung(maHoaDon);
        txtTienDoDung.setText(Transform.SoString(Math.ceil(tienDoDung)));
        BLLOrder.thanhToanTien(txtGioVao, txtGioRa, txtTienGio, txtTongTien, txtThanhTien, khuyenMai, txtTienKhuyenMai, maKhuyenMai);
        jpnBan.removeAll();
        MyComboBox cbbKhuVuc = (MyComboBox) CBBKhuVuc.getSelectedItem();

        int maKhuVuc = cbbKhuVuc.MaInt();
        MyComboBox cbbLoaiBan = (MyComboBox) CBBLoaiBan.getSelectedItem();
        int maLoaiBan = cbbLoaiBan.MaInt();
        loadBan(maKhuVuc, maLoaiBan);
        btnXong.setEnabled(true);
        btnThanhToan.setEnabled(false);
        btnQuetMaQR.setVisible(true);
        SwingUtilities.updateComponentTreeUI(jpnBan);
    }//GEN-LAST:event_btnThanhToanActionPerformed

    private void btnXongActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXongActionPerformed
        // TODO add your handling code here:
        txtGioVao.setText("");
        txtGioRa.setText("");
        txtTienDoDung.setText("");
        txtTienGio.setText("");
        txtTongTien.setText("");
        txtTienKhuyenMai.setText("");
        txtThanhTien.setText("");
        String tenBan = txtBan.getText();
        ArrayList<Ban> arrBan = BLLOrder.findTableByName(tenBan);
        if (arrBan.get(0).getTinhTrang().equals("1")) {
            btnXong.setEnabled(false);
            btnQuetMaQR.setVisible(false);
            return;
        }
        DefaultTableModel model = (DefaultTableModel) tblSPDaGoi.getModel();
        model.setRowCount(0);
        model.setColumnCount(0);
        btnXong.setEnabled(false);
        btnQuetMaQR.setVisible(false);
    }//GEN-LAST:event_btnXongActionPerformed
    public static boolean updateBan = false;
    private void btnChuyenBanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnChuyenBanActionPerformed
        // TODO add your handling code here:
        jdlTuyChon tuyChon = new jdlTuyChon(null, true);
        tuyChon.setVisible(true);

        if (updateBan) {
            jpnBan.removeAll();
            MyComboBox cbbKhuVuc = (MyComboBox) CBBKhuVuc.getSelectedItem();

            int maKhuVuc = cbbKhuVuc.MaInt();
            MyComboBox cbbLoaiBan = (MyComboBox) CBBLoaiBan.getSelectedItem();
            int maLoaiBan = cbbLoaiBan.MaInt();
            loadBan(maKhuVuc, maLoaiBan);
            SwingUtilities.updateComponentTreeUI(jpnBan);
            updateBan = false;
        }

    }//GEN-LAST:event_btnChuyenBanActionPerformed

    private void btnQuetMaQRActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnQuetMaQRActionPerformed
        // TODO add your handling code here:
        double tongtien = BLLOrder.thanhTien;
        System.out.println("tong tien " + tongtien);
        QRCode.money = tongtien;
        QRCodeImage codeImage = new QRCodeImage(null, true);
        codeImage.setVisible(true);
//        System.out.println("tổng tiền : "+tongtien);
    }//GEN-LAST:event_btnQuetMaQRActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    public javax.swing.JComboBox<String> CBBKhuVuc;
    public javax.swing.JComboBox<String> CBBLoaiBan;
    private javax.swing.JComboBox<String> CBBSanPham;
    private javax.swing.JButton btnChuyenBan;
    private javax.swing.JButton btnLuu;
    private javax.swing.JButton btnQuetMaQR;
    private javax.swing.JButton btnThanhToan;
    private javax.swing.JButton btnXong;
    private javax.swing.JComboBox<String> cbbKhuyenMai;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JMenuItem jMenuItem3;
    private javax.swing.JMenuItem jMenuItem7;
    private javax.swing.JMenuItem jMenuItem8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    public javax.swing.JPanel jpnBan;
    private javax.swing.JPopupMenu ppmenu;
    private javax.swing.JTable tblSPDaGoi;
    private javax.swing.JTable tblSanPham;
    private javax.swing.JTextField txtBan;
    private javax.swing.JLabel txtGioRa;
    private javax.swing.JLabel txtGioVao;
    private javax.swing.JLabel txtTenKhuyenMai;
    private javax.swing.JLabel txtThanhTien;
    private javax.swing.JLabel txtTienDoDung;
    private javax.swing.JLabel txtTienGio;
    private javax.swing.JLabel txtTienKhuyenMai;
    private javax.swing.JLabel txtTongTien;
    // End of variables declaration//GEN-END:variables
}
